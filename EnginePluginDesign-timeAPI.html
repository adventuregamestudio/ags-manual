<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Engine Plugin Design-time API</title>
  <link rel="stylesheet" href="css/normalize.css" />
  <link rel="stylesheet" href="css/main.css" />
  <link href="static/favicon.ico" rel="icon" type="image/x-icon" />
</head>
<body>


  <div class="header-bg"></div>
  <div class="container">
    <header>
      <h1>
        <a href="index.html">
          <img src="static/logo.svg" id="cup" width="48" height="48">
          AGS Manual
        </a>
      </h1>
      <label class="header_input search-box">
        <input type="search" id="search_input" placeholder="Search">
        <label class="toggle-icon" title="Match Case">
          <input type="checkbox" id="citoggle" onclick="citoggle_clicked()">
          <span>Aa</span>
        </label>
        <label class="toggle-icon" title="Match Whole Word">
          <input type="checkbox" id="wwtoggle" onclick="wwtoggle_clicked()" checked="checked">
          <span><u>ab</u></span>
        </label>
      </label>

      <label class="toggle-icon" title="Highlight">
        <input type="checkbox" id="hltoggle" onclick="hltoggle_clicked()" checked="checked">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="24px" height="24px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" class="iconify iconify--carbon"><path fill="currentColor" d="M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z"></path><path fill="currentColor" d="M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z"></path></svg>
      </label>
      
      <label class="toggle-icon" title="Toggle dark mode">
        <input type="checkbox" checked="checked"  id="dark_mode_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26a5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" /></svg>
      </label>
      
      <label class="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 32 32" width="24px" fill="currentColor"><path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z" /></svg>
      </label>

      <script src="js/darkmode.js"></script>
      <script src="js/mark.min.js"></script>

      <ul id="search_results"></ul>
    </header>

  <nav>
    <ul>
      <li><a href="genindex.html">Index</a></li>
    </ul>
  </nav>

  <div class="content">
    <article>
      <main>
<section id="engine-plugin-design-time-api" class="level2">
<h2><a href="#engine-plugin-design-time-api">Engine Plugin Design-time API</a></h2>
<p>Since the AGS Editor is currently windows only, you can use a macro to not include the design-time parts when building the plugin for other platforms.</p>
<section id="dllmain" class="level3">
<h3><a href="#dllmain">DllMain</a></h3>
<p>Your DLL should have the following entry points:</p>
<p>The standard Windows DLL entry point, you know how to use this.</p>
<p>This will get called once when the editor first starts up, and once when it finally shuts down. The plugins are kept in memory at all times, so you will not get lots of load-unloads during the editor's lifetime.</p>
</section>
<section id="design-time-events" class="level3">
<h3><a href="#design-time-events">Design-time events</a></h3>
<section id="ags_getpluginname" class="level4">
<h4>AGS_GetPluginName</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT LPCSTR AGS_GetPluginName <span class="op">();</span></span></code></pre></div>
<p>Called by the editor to retrieve a user-friendly name for the plugin. This is the very first function the editor calls as soon as it starts up, in order to build its list of plugins.</p>
<p>Normally, you will implement this as a simple one-line function that returns a static string with the plugin description.</p>
</section>
<section id="ags_editorstartup" class="level4">
<h4>AGS_EditorStartup</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">int</span> AGS_EditorStartup <span class="op">(</span>IAGSEditor <span class="op">*</span>lpEditor<span class="op">);</span></span></code></pre></div>
<p>Called by the editor when the user selects to add the plugin to their game. This function should perform any initialization necessary for design-time operation.</p>
<p>The parameter passed to the function is a pointer to the editor interface, which your plugin can execute various methods on to communicate with the editor.</p>
<p>In particular, this function should register any additions to the script header files that it uses.</p>
<p>You should return 0 to indicate success; any other value indicates that a problem occurred, and the editor will not attempt any further communication with the plugin unless the user tries to start it again.</p>
</section>
<section id="ags_editorshutdown" class="level4">
<h4>AGS_EditorShutdown</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">void</span> AGS_EditorShutdown <span class="op">();</span></span></code></pre></div>
<p>Called by the editor when the user elects to remove the plugin from their game. The plugin should un-register anything that it registered at startup, since if the user later decides to add the plugin again, the Startup function will be run again.</p>
</section>
<section id="ags_editorproperties" class="level4">
<h4>AGS_EditorProperties</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">void</span> AGS_EditorProperties <span class="op">(</span>HWND parent<span class="op">);</span></span></code></pre></div>
<p><em>(Optional - plugin does not have to have this function)</em></p>
<p>Called by the editor when the user highlights the plugin and clicks the Properties button. You can use this to display a copyright message, or allow the user to set options for your plugin, for instance. This will only be called when the plugin is selected (i.e. <code>EditorStartup</code> has been called).</p>
<p>The parameter gives you the parent window handle you should use if you want to pop up a dialog. You should make any dialogs modal so that this function does not return until they are dismissed.</p>
</section>
<section id="ags_editorsavegame" class="level4">
<h4>AGS_EditorSaveGame</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">int</span> AGS_EditorSaveGame <span class="op">(</span><span class="dt">char</span> <span class="op">*</span>buffer<span class="op">,</span> <span class="dt">int</span> bufsize<span class="op">);</span></span></code></pre></div>
<p><em>(Optional - plugin does not have to have this function)</em></p>
<p>Called by the editor when the current game is saved to disk. This will only be called if your plugin is selected into the current game.</p>
<p><code>buffer</code> is a byte array of size <code>bufsize</code>, which you can write any data to as you see fit. The buffer will then be written into the user's game file. You must return the number of bytes actually used, which can be up to and including <code>bufsize</code>.</p>
<p>If you need more storage space than <code>bufsize</code> provides, you will have to write your own separate file out to disk, store in the registry, or do some compression.</p>
<p>The current version of AGS gives you a 5120 byte buffer, but future versions may increase or decrease this amount, so be sure to check <code>bufsize</code> before using it.</p>
<p>You will probably only need this function if you have some options in the Properties that the user can set, otherwise there's no need to use it.</p>
</section>
<section id="ags_editorloadgame" class="level4">
<h4>AGS_EditorLoadGame</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">void</span> AGS_EditorLoadGame <span class="op">(</span><span class="dt">char</span> <span class="op">*</span>buffer<span class="op">,</span> <span class="dt">int</span> bufsize<span class="op">);</span></span></code></pre></div>
<p><em>(Optional - plugin does not have to have this function)</em></p>
<p>Called by the editor when a game is loaded from disk. This will only be called if your plugin is selected into the new game.</p>
<p><code>buffer</code> is a byte array of size <code>bufsize</code>, which contains any data you wrote out in a previous session with <code>AGS_EditorSaveGame</code>. Note that the buffer is not persistent - when your function returns, the buffer is freed, so you should copy any important data you need to elsewhere.</p>
</section>
<section id="ags_pluginv2" class="level4">
<h4>AGS_PluginV2</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DLLEXPORT <span class="dt">int</span> AGS_PluginV2 <span class="op">();</span></span></code></pre></div>
<p>This entry point is never called by AGS, but it must be present and exported from your DLL in order to let AGS know that it is a valid plugin that supports version 5 and later of the engine interface. If you don't export this, AGS won't load the plugin.</p>
</section>
</section>
<section id="the-iagseditor-interface" class="level3">
<h3><a href="#the-iagseditor-interface">The IAGSEditor interface</a></h3>
<p>This interface is provided to the plugin as the way of calling back to the editor. It provides these members:</p>
<section id="iagseditorversion" class="level4">
<h4>IAGSEditor.version</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> version<span class="op">;</span></span></code></pre></div>
<p>Specifies the interface version. You should check this to determine what version of the editor is being used, because certain interface methods will have been added in later versions, and attempting to use them with an earlier version will crash the system.</p>
<p>The current version number for the latest version of AGS is <strong>1</strong>.</p>
</section>
<section id="iagseditorgeteditorhandle" class="level4">
<h4>IAGSEditor.GetEditorHandle</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>HWND GetEditorHandle <span class="op">();</span></span></code></pre></div>
<p>Returns the window handle to the AGS Editor's main frame. This might be useful if you wanted to add extra menu options to the editor, for example.</p>
<p><em>Added in version: 1</em></p>
</section>
<section id="iagseditorgetwindowhandle" class="level4">
<h4>IAGSEditor.GetWindowHandle</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>HWND GetWindowHandle <span class="op">();</span></span></code></pre></div>
<p>Returns the window handle to the current active window. If you want to pop up a messagebox, for instance, you should always use this handle as the parent, because using the main frame's handle would un-modal any dialog boxes currently displayed.</p>
<p><em>Added in version: 1</em></p>
</section>
<section id="iagseditorregisterscriptheader" class="level4">
<h4>IAGSEditor.RegisterScriptHeader</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> RegisterScriptHeader <span class="op">(</span><span class="at">const</span> <span class="dt">char</span> <span class="op">*</span> header<span class="op">);</span></span></code></pre></div>
<p>Adds the contents of <code>header</code> to the built-in script header, which is compiled into every script in the game. The idea here is that you would use this to register your text script functions, for example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>header <span class="op">=</span> <span class="st">&quot;import int Add (int, int);</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                <span class="kw">import</span> <span class="dt">int</span> Substract<span class="op">(</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">);</span> <span class="st">&quot;;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>RegisterScriptHeader <span class="op">(</span>header<span class="op">);</span></span></code></pre></div>
<p>Note that the editor only keeps a reference to this string rather than a copy, so do not overwrite or destroy the string after calling this function.</p>
<p><em>Added in version: 1</em></p>
</section>
<section id="iagseditorunregisterscriptheader" class="level4">
<h4>IAGSEditor.UnregisterScriptHeader</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> UnregisterScriptHeader <span class="op">(</span><span class="at">const</span> <span class="dt">char</span> <span class="op">*</span>header<span class="op">);</span></span></code></pre></div>
<p>Unregisters the specified script header, which you earlier used with <code>RegisterScriptHeader</code>.</p>
<p><em>Added in version: 1</em></p>
</section>
</section>
</section>
      <a class="edit-link" href="https://github.com/adventuregamestudio/ags-manual-source/blob/master/EnginePluginDesign-timeAPI.md" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit this page</a>
      </main>
      <footer>
        <p>
          <a href="jslicensing.html" data-jslicense="1">Third-party JavaScript licensing</a><br>
          Build: ed75ea05a92de6b9ff5582c5376524816e60c494
        </p>
      </footer>
    </article>
    
    <aside>
<ul>
<li><a href="#engine-plugin-design-time-api" id="toc-engine-plugin-design-time-api">Engine Plugin Design-time API</a>
<ul>
<li><a href="#dllmain" id="toc-dllmain">DllMain</a></li>
<li><a href="#design-time-events" id="toc-design-time-events">Design-time events</a></li>
<li><a href="#the-iagseditor-interface" id="toc-the-iagseditor-interface">The IAGSEditor interface</a></li>
</ul></li>
</ul>
    </aside>
  </div>




  </div>
  <script src="js/navigation.js"></script>
  <script src="js/search.js"></script>
  
</body>
</html>
