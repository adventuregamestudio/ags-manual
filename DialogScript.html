<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Dialog Script</title>
  <link rel="stylesheet" href="css/normalize.css" />
  <link rel="stylesheet" href="css/main.css" />
  <link href="static/favicon.ico" rel="icon" type="image/x-icon" />
</head>
<body>


  <div class="header-bg"></div>
  <div class="container">
    <header>
      <h1>
        <a href="index.html">
          <img src="static/logo.svg" id="cup" width="48" height="48">
          AGS Manual
        </a>
      </h1>
      <label class="header_input search-box">
        <input type="search" id="search_input" placeholder="Search">
        <label class="toggle-icon" title="Match Case">
          <input type="checkbox" id="citoggle" onclick="citoggle_clicked()">
          <span>Aa</span>
        </label>
        <label class="toggle-icon" title="Match Whole Word">
          <input type="checkbox" id="wwtoggle" onclick="wwtoggle_clicked()" checked="checked">
          <span><u>ab</u></span>
        </label>
      </label>

      <label class="toggle-icon" title="Highlight">
        <input type="checkbox" id="hltoggle" onclick="hltoggle_clicked()" checked="checked">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="24px" height="24px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" class="iconify iconify--carbon"><path fill="currentColor" d="M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z"></path><path fill="currentColor" d="M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z"></path></svg>
      </label>
      
      <label class="toggle-icon" title="Toggle dark mode">
        <input type="checkbox" checked="checked"  id="dark_mode_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26a5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" /></svg>
      </label>
      
      <label class="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 32 32" width="24px" fill="currentColor"><path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z" /></svg>
      </label>

      <script src="js/darkmode.js"></script>
      <script src="js/mark.min.js"></script>

      <ul id="search_results"></ul>
    </header>

  <nav>
    <ul>
      <li><a href="genindex.html">Index</a></li>
    </ul>
  </nav>

  <div class="content">
    <article>
      <main>
<section id="dialog-script" class="level2">
<h2><a href="#dialog-script">Dialog Script</a></h2>
<p>Dialog scripts are scripts that run when a dialog starts or one of the options is executed, for example, when player selects it in the list of available options. Dialog scripts are streamlined for conversations and use an extended variant of script syntax that simplifies several common commands.</p>
<p>With a newly created dialog topic, all you will see in the script is a number of lines starting with an '@' symbol. In the dialog script, these signify the starting points of the script for each option. For example, when the player clicks on option 3, the script will begin on the line following "@3". There is also a special starting point, called "@S". This is run when the conversation starts, before any choices are given to the player. This could be used to display a "Hello" message or something similar.</p>
<p>To display some speech, you begin the line with the character's SCRIPT NAME (not full name), followed by a colon, then a space, and then what you want them to say. For example, if my main character's script name is EGO, I would write</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode agsdialog"><code class="sourceCode agsdialog"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="st">ego</span><span class="op">:</span> &quot;I am very happy today because it&#39;s my birthday.&quot;</span></code></pre></div>
<p>The character name is used by the system to choose the correct color for the text.</p>
<p><strong>IMPORTANT:</strong> Do <strong>NOT</strong> include the "c" at the start of the character's script name here.</p>
<p>You can also use the special character name "narrator", which displays the text in the pop-up message box instead of as speech text; and the alias "player", which will say it as the current player character - useful if you don't know which character the player will be controlling when they speak the conversation.</p>
<p>If you just use <code>...</code> as the text for a character to say, the game will pause briefly as if they are stopping to think, and nothing will be displayed.</p>
<p>To signal the end of the script for this option, place a "return" command on the last line of it. For example,</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode agsdialog"><code class="sourceCode agsdialog"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">@1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="st">ego</span><span class="op">:</span> &quot;Hello. How are you?&quot;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ss">narrator</span><span class="op">:</span> The man looks you in the eye.</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="st">otherman</span><span class="op">:</span> <span class="at">...</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">otherman</span><span class="op">:</span> &quot;I&#39;m fine.&quot;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span></span></code></pre></div>
<p>"return" tells AGS to go back and display the choices again to the player. If you use "stop" instead of return, then the conversation is ended. Alternatively, you can use "goto-dialog" or "goto-previous", which abort the current dialog script and transfer control to the new dialog.</p>
<p><strong>NOTE:</strong> Do <strong>NOT</strong> indent these lines with spaces or tabs. Indented lines signify that AGS should interpret the line as a normal scripting command rather than a dialog scripting command (see below).</p>
<section id="dialog-commands" class="level3">
<h3><a href="#dialog-commands">Dialog commands</a></h3>
<p>The dialog commands available are:</p>
<ul>
<li><strong>goto-dialog X</strong><br> Switches the current topic to Topic X, and displays the current list of choices for that topic.</li>
<li><strong>goto-previous</strong><br> Returns to the previous topic that this one was called from. If the dialog started on this topic, then the dialog will be stopped.</li>
<li><strong>option-off X</strong><br> Turns option X for the current topic off, meaning it won't be displayed in the list of choices next time.</li>
<li><strong>option-off-forever X</strong><br> Turns option X off permanently. It will never again be displayed, not even if an "option-on" command is used.</li>
<li><strong>option-on X</strong><br> Turns option X for the current topic on, including it in the list of choices to the player next time they are displayed.</li>
<li><strong>run-script X</strong><br> Calls <a href="Globalfunctions_Event.html#dialog_request">dialog_request</a> event handler if one is present in the game script, passes <code>X</code> as an integer parameter.</li>
<li><strong>return</strong><br> Stops the script and returns to the list of choices.</li>
<li><strong>stop</strong><br> Stops the conversation and returns the player to the game.</li>
</ul>
</section>
<section id="substituting-dialog-speech-with-custom-functions" class="level3">
<h3><a href="#substituting-dialog-speech-with-custom-functions">Substituting dialog speech with custom functions</a></h3>
<p>By default all of the character dialog lines are executed using the standard function Character.Say. Since AGS 3.5.0 it is possible to define a custom script function as a substitute instead. This is done using "Custom Say function in dialog scripts" option in the General Settings. Similarly, narration (which is by default done using Display script function) may be substituted with a custom one using "Custom Narrate function in dialog scripts".</p>
<p>These custom functions should be declared as imports in one of your script headers.<br> "Custom Say" function must have one of the following two declaration forms:<br> <code>void MySay(Character* c, const string text); // use ex: MySay(player, "Hello");</code><br> or<br> <code>void MySay(this Character*, const string text); // use ex: player.MySay("Hello");</code></p>
<p>"Custom Narrate" function must have following declaration form:<br> <code>void MyNarrate(const string text);</code></p>
<p><strong>IMPORTANT:</strong> There's currently a limitation that, if Say checkbox for dialog options is checked, it will use regular <code>Character.Say</code> despite defining a custom Say function.<br> If you still want to have player pronounce dialog option text, one of the solutions is to add a call to your custom speech function as the first line in every dialog option script:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode agsdialog"><code class="sourceCode agsdialog"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>@X</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">player</span><span class="op">.</span><span class="at">MySay</span><span class="op">(</span><span class="kw">this</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span> X <span class="op">));</span> \\ where X is the actual option index</span></code></pre></div>
<p>If you wonder how such function will work in dialogs, see the following topic below.</p>
</section>
<section id="using-regular-scripting-commands-in-dialogs" class="level3">
<h3><a href="#using-regular-scripting-commands-in-dialogs">Using regular scripting commands in dialogs</a></h3>
<p>Often the provided dialog scripting commands won't be enough for what you want to do in the dialog. You might want to give the player an inventory item or add some points to their score, for example.</p>
<p>AGS now lets you put normal scripting commands in your dialog script, by indenting the line with spaces or tabs. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode agsdialog"><code class="sourceCode agsdialog"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="at">@1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">ego</span><span class="op">:</span> &quot;Hello. How are you?&quot;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ss">narrator</span><span class="op">:</span> The man looks you in the eye.</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">player</span><span class="op">.</span><span class="at">AddInventory</span><span class="op">(</span>iKey<span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Display</span><span class="op">(</span><span class="st">&quot;This line is displayed from a normal script command&quot;</span><span class="op">);</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">otherman</span><span class="op">:</span> &quot;I&#39;m fine.&quot;</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span></span></code></pre></div>
<p>Here, you can see dialog script commands being used, but also then a couple of normal scripting commands have been inserted, on indented lines.</p>
<p>When working with dialog scripts, the <strong>this</strong> keyword allows you to access the currently running dialog.</p>
<p>If you want to conditionally break out of the dialog script, the special tokens <code>RUN_DIALOG_GOTO_PREVIOUS</code>, <code>RUN_DIALOG_RETURN</code> and <code>RUN_DIALOG_STOP_DIALOG</code> are available which you can <code>return</code> from inside a script block. For example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode agsdialog"><code class="sourceCode agsdialog"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="at">@1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">ego</span><span class="op">:</span> &quot;Hello. How are you?&quot;</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ss">narrator</span><span class="op">:</span> The man looks you in the eye.</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="bu">player</span><span class="op">.</span><span class="at">HasInventory</span><span class="op">(</span>iKey<span class="op">))</span> <span class="op">{</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">player</span><span class="op">.</span><span class="at">Say</span><span class="op">(</span><span class="st">&quot;Actually, I&#39;d better go.&quot;</span><span class="op">);</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="cn">RUN_DIALOG_STOP_DIALOG</span><span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">otherman</span><span class="op">:</span> &quot;Here&#39;s a key for you.&quot;</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span></span></code></pre></div>
</section>
</section>
      <a class="edit-link" href="https://github.com/adventuregamestudio/ags-manual-source/blob/master/DialogScript.md" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit this page</a>
      </main>
      <footer>
        <p>
          <a href="jslicensing.html" data-jslicense="1">Third-party JavaScript licensing</a><br>
          Build: ed75ea05a92de6b9ff5582c5376524816e60c494
        </p>
      </footer>
    </article>
    
    <aside>
<ul>
<li><a href="#dialog-script" id="toc-dialog-script">Dialog Script</a>
<ul>
<li><a href="#dialog-commands" id="toc-dialog-commands">Dialog commands</a></li>
<li><a href="#substituting-dialog-speech-with-custom-functions" id="toc-substituting-dialog-speech-with-custom-functions">Substituting dialog speech with custom functions</a></li>
<li><a href="#using-regular-scripting-commands-in-dialogs" id="toc-using-regular-scripting-commands-in-dialogs">Using regular scripting commands in dialogs</a></li>
</ul></li>
</ul>
    </aside>
  </div>




  </div>
  <script src="js/navigation.js"></script>
  <script src="js/search.js"></script>
  
</body>
</html>
