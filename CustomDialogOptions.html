<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Custom dialog options rendering</title>
  <link rel="stylesheet" href="css/normalize.css" />
  <link rel="stylesheet" href="css/main.css" />
  <link href="static/favicon.ico" rel="icon" type="image/x-icon" />
</head>
<body>


  <div class="header-bg"></div>
  <div class="container">
    <header>
      <h1>
        <a href="index.html">
          <img src="static/logo.svg" id="cup" width="48" height="48">
          AGS Manual
        </a>
      </h1>
      <label class="header_input search-box">
        <input type="search" id="search_input" placeholder="Search">
        <label class="toggle-icon" title="Match Case">
          <input type="checkbox" id="citoggle" onclick="citoggle_clicked()">
          <span>Aa</span>
        </label>
        <label class="toggle-icon" title="Match Whole Word">
          <input type="checkbox" id="wwtoggle" onclick="wwtoggle_clicked()" checked="checked">
          <span><u>ab</u></span>
        </label>
      </label>

      <label class="toggle-icon" title="Highlight">
        <input type="checkbox" id="hltoggle" onclick="hltoggle_clicked()" checked="checked">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="24px" height="24px" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" class="iconify iconify--carbon"><path fill="currentColor" d="M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z"></path><path fill="currentColor" d="M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z"></path></svg>
      </label>
      
      <label class="toggle-icon" title="Toggle dark mode">
        <input type="checkbox" checked="checked"  id="dark_mode_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26a5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z" /></svg>
      </label>
      
      <label class="mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 32 32" width="24px" fill="currentColor"><path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z" /></svg>
      </label>

      <script src="js/darkmode.js"></script>
      <script src="js/mark.min.js"></script>

      <ul id="search_results"></ul>
    </header>

  <nav>
    <ul>
      <li><a href="genindex.html">Index</a></li>
    </ul>
  </nav>

  <div class="content">
    <article>
      <main>
<section id="custom-dialog-options-rendering" class="level2">
<h2><a href="#custom-dialog-options-rendering">Custom dialog options rendering</a></h2>
<p>By default, AGS comes with two types of dialog options -- displaying them using the size and position of an existing GUI, or creating a text window to display the options in.</p>
<p>As of AGS 3.1 and above, if neither of these methods suit you (for example, because you want to use picture-based dialog options, or you want to add scroll arrows), you can now implement the dialog options display yourself in the script.</p>
<p><strong>NOTE:</strong> This topic involves some advanced scripting. If you're just starting out with AGS, please just use one of the built-in dialog option styles for now, and come back to this later when you're comfortable with scripting.</p>
<p>To write your custom dialog options code, you need to add a number of even handlers in your script, taken from the list below. <em>Two of them must be present</em> (<code>dialog_options_get_dimensions</code> and <code>dialog_options_render</code>), but others are optional, so use only those that match your game needs. These function would work somewhat similar to the <a href="Globalfunctions_Event.html">common event handlers</a>, except they are only run whenever the dialog options are on screen.</p>
<p>All of these functions accept <a href="DialogOptionsRenderingInfo.html"><code>DialogOptionsRenderingInfo</code></a> object as a first argument. This object may be used to get and set various properties, including accessing current Dialog object.</p>
<p><strong>NOTE:</strong> These functions don't have to go in the global script; you can put them in any script you like. However, beware that if the functions are present in more than one script they could interfere with each other and cause problems.</p>
<p><strong>COMPATIBILITY NOTE:</strong> The older versions of AGS (pre-3.4.0) were working with somewhat different set of functions. There was no <code>dialog_options_repexec</code> and <code>dialog_options_key_press</code>, but you had to add <code>dialog_options_get_active</code> function instead in which you'd set an active dialog option (or none) on each game update, for example, depending on the cursor position. Mouse clicks were processed by the engine, and if an active option was set in <code>dialog_options_get_active</code> then it was run automatically. There is a compatibility switch in the General Settings called "Use old-style dialog options rendering API" that toggles between the old and new behavior. If you have imported older project and want to keep old dialog option scripts, then make sure it's enabled. If you wish to update your game to the new behavior, then turn it off.</p>
<p><strong>IMPORTANT:</strong> All of the Custom Dialog functions run on the non-blocking thread. That means that you should not make any blocking calls, such as Character.Say, Wait or Display within them, as they may not behave correctly.</p>
<hr />
<section id="dialog_options_get_dimensions" class="level3">
<h3><a href="#dialog_options_get_dimensions"><code>dialog_options_get_dimensions</code></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dialog_options_get_dimensions<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span></code></pre></div>
<p>This is the first function that will be called before dialog options are shown. It is meant to find out which part of the screen you will be drawing onto. Do that by setting the X, Y, Width and Height properties of the <code>info</code> struct. Only when the width and height are greater than 0 will the custom dialog system be activated.</p>
<p><strong>NOTE:</strong> you may also use this function to set other things up, not only <code>DialogOptionsRenderingInfo</code>.</p>
<hr />
</section>
<section id="dialog_options_render" class="level3">
<h3><a href="#dialog_options_render"><code>dialog_options_render</code></a></h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dialog_options_render<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span></code></pre></div>
<p>This function is called right before the dialog options are shown or updated on screen. The <code>info</code> struct will supply a <a href="DrawingSurface.html"><code>DrawingSurface</code></a> which may be accessed using <code>info.Surface</code> property, and which you may draw upon.</p>
<hr />
</section>
<section id="dialog_options_mouse_click" class="level3">
<h3><a href="#dialog_options_mouse_click"><code>dialog_options_mouse_click</code></a></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dialog_options_mouse_click<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">,</span> <span class="dt">MouseButton</span> button<span class="op">,</span> <span class="dt">int</span> mx<span class="op">,</span> <span class="dt">int</span> my<span class="op">)</span></span></code></pre></div>
<p>This function is called if the player clicks the mouse anywhere on dialog options. It corresponds to the regular <a href="Globalfunctions_Event.html#on_mouse_click"><code>on_mouse_click</code></a>. You might want to use this to process clicks on dialog options, and also on some custom elements like scroll arrows, for example.</p>
<p>The <code>mx</code> and <code>my</code> parameters contain mouse's position at the time of click. They are more reliable than using global variables <code>mouse.x</code> and <code>mouse.y</code>, because this function may be called with a small delay when the mouse have already moved away a bit. These parameters contain position in <em>screen coordinates</em>, as sometimes it may be necessary to know if player clicked outside of the dialog options bounds. Subtract <a href="DialogOptionsRenderingInfo.html#dialogoptionsrenderinginfox">DialogOptionsRenderInfo.X</a> and Y property values from these to tell the relative position.</p>
<hr />
</section>
<section id="dialog_options_key_press" class="level3">
<h3><a href="#dialog_options_key_press"><code>dialog_options_key_press</code></a></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dialog_options_key_press<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">,</span> <span class="dt">eKeyCode</span> keycode<span class="op">,</span> <span class="dt">int</span> mod<span class="op">)</span></span></code></pre></div>
<p>This function is called if the player presses any key while custom dialog options are shown on screen. It corresponds to the regular <a href="Globalfunctions_Event.html#on_key_press"><code>on_key_press</code></a>, and you can use this to implement key-controlled selection of dialog option, for example.</p>
<p><strong>Compatibility:</strong> the optional <code>mod</code> argument is supported since <strong>AGS 3.6.0</strong>. Please refer to the <a href="Globalfunctions_Event.html#on_key_press"><code>on_key_press</code></a> description for details.</p>
<hr />
</section>
<section id="dialog_options_text_input" class="level3">
<h3><a href="#dialog_options_text_input"><code>dialog_options_text_input</code></a></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dialog_options_text_input<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">,</span> <span class="dt">int</span> ch<span class="op">)</span></span></code></pre></div>
<p>This function is called if the player's key presses form a printable character. It corresponds to the regular <a href="Globalfunctions_Event.html#on_text_input"><code>on_text_input</code></a>, and you can use this to handle a custom text input in your dialog options.</p>
<p><strong>Compatibility:</strong> Supported by AGS 3.6.0 and above. <code>dialog_options_text_input</code> will only work if you have "Use old-style key handling" option disabled in the "General Settings".</p>
<hr />
</section>
<section id="dialog_options_repexec" class="level3">
<h3><a href="#dialog_options_repexec"><code>dialog_options_repexec</code></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dialog_options_repexec<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span></code></pre></div>
<p>This function works similar to a general <a href="Globalfunctions_Event.html#repeatedly_execute"><code>repeatedly_execute</code></a> function, but is called only while the dialog options are shown on the screen. You may use this to update the dialog options state, for example, for determining which option the mouse is currently hovering over, or scripting timed actions.</p>
<hr />
</section>
<section id="dialog_options_close" class="level3">
<h3><a href="#dialog_options_close"><code>dialog_options_close</code></a></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dialog_options_close<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span></code></pre></div>
<p>This function will be called right before the dialog options are removed from the screen. This is a place to perform a "cleanup" in case you need to dispose temporary resources (like dynamic sprites), hide GUIs, stop sounds, and so forth.</p>
<p><strong>NOTE:</strong> this is not the same as the end of the current dialog. Dialog options may be shown and hidden multiple times during the dialog, every time the game lets player to choose a dialog option.</p>
<p><strong>Compatibility:</strong> Supported by AGS 3.6.0 and above.</p>
<hr />
</section>
<section id="dialog_options_get_active" class="level3">
<h3><a href="#dialog_options_get_active"><code>dialog_options_get_active</code></a></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dialog_options_get_active<span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span></code></pre></div>
<p><em>Compatibility:</em> <code>dialog_options_get_active</code> is a deprecated function that works only if you have "Use old-style dialog options rendering API" enabled in General Settings. In a modern script use <code>dialog_options_repexec</code> instead.</p>
<p>This function is called as the player moves the mouse around the screen. This needs to work out which option the mouse is currently hovering over, so that AGS knows which option to process if the player clicks the mouse button. Use it to set <code>info.ActiveOptionID</code> property, or do any other changes.</p>
<hr />
</section>
<section id="example-a-classic-mouse-controls" class="level3">
<h3><a href="#example-a-classic-mouse-controls">Example A. Classic mouse controls</a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_color = <span class="dv">14</span><span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_acolor = <span class="dv">13</span><span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_ncolor = <span class="dv">4</span><span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_get_dimensions</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create a 200x200 dialog options area at (50,100)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">X</span> = <span class="dv">50</span><span class="op">;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Y</span> = <span class="dv">100</span><span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Width</span> = <span class="dv">200</span><span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Height</span> = <span class="dv">200</span><span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Enable alpha channel for the drawing surface</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">HasAlphaChannel</span> = <span class="bu">true</span><span class="op">;</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Put the text parser at the bottom (if enabled)</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">ParserTextBoxX</span> = <span class="dv">10</span><span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">ParserTextBoxY</span> = <span class="dv">160</span><span class="op">;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">ParserTextBoxWidth</span> = <span class="dv">180</span><span class="op">;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_render</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">Clear</span><span class="op">(</span>dlg_opt_color<span class="op">);</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ypos = <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Render all the options that are enabled</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i = <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">OptionCount</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionState</span><span class="op">(</span>i<span class="op">)</span> <span class="op">==</span> <span class="bu">eOptionOn</span><span class="op">)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">ActiveOptionID</span> <span class="op">==</span> i<span class="op">)</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawingColor</span> = dlg_opt_acolor<span class="op">;</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawingColor</span> = dlg_opt_ncolor<span class="op">;</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>            info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawStringWrapped</span><span class="op">(</span><span class="dv">5</span><span class="op">,</span> ypos<span class="op">,</span> info<span class="op">.</span><span class="at">Width</span> <span class="op">-</span> <span class="dv">10</span><span class="op">,</span> <span class="bu">eFontNormal</span><span class="op">,</span> <span class="bu">eAlignLeft</span><span class="op">,</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                                           info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span>i<span class="op">));</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>            ypos <span class="op">+</span>= <span class="bu">GetTextHeight</span><span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span>i<span class="op">),</span> <span class="bu">eFontNormal</span><span class="op">,</span> info<span class="op">.</span><span class="at">Width</span> <span class="op">-</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_repexec</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">ActiveOptionID</span> = <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span><span class="bu">mouse</span><span class="op">.</span><span class="at">y</span> <span class="op">&lt;</span> info<span class="op">.</span><span class="at">Y</span> <span class="op">||</span> <span class="bu">mouse</span><span class="op">.</span><span class="at">y</span> <span class="op">&gt;=</span> info<span class="op">.</span><span class="at">Y</span> <span class="op">+</span> info<span class="op">.</span><span class="at">Height</span> <span class="op">||</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="bu">mouse</span><span class="op">.</span><span class="at">x</span> <span class="op">&lt;</span> info<span class="op">.</span><span class="at">X</span> <span class="op">||</span> <span class="bu">mouse</span><span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> info<span class="op">.</span><span class="at">X</span> <span class="op">+</span> info<span class="op">.</span><span class="at">Width</span><span class="op">)</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span> <span class="co">// return if the mouse is outside UI bounds</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ypos = <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Find the option that corresponds to where the mouse cursor is</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i = <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">OptionCount</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionState</span><span class="op">(</span>i<span class="op">)</span> <span class="op">==</span> <span class="bu">eOptionOn</span><span class="op">)</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>            ypos <span class="op">+</span>= <span class="bu">GetTextHeight</span><span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span>i<span class="op">),</span> <span class="bu">eFontNormal</span><span class="op">,</span> info<span class="op">.</span><span class="at">Width</span> <span class="op">-</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">((</span><span class="bu">mouse</span><span class="op">.</span><span class="at">y</span> <span class="op">-</span> info<span class="op">.</span><span class="at">Y</span><span class="op">)</span> <span class="op">&lt;</span> ypos<span class="op">)</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">ActiveOptionID</span> = i<span class="op">;</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span><span class="op">;</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_mouse_click</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">,</span> <span class="dt">MouseButton</span> button<span class="op">)</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">ActiveOptionID</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>        info<span class="op">.</span><span class="at">RunActiveOption</span><span class="op">();</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The examples above are slightly naive; in reality you would probably want to track the Y position of each option in a variable to save having to continually scan through all the options.</p>
<hr />
</section>
<section id="example-b-keyboard-controls" class="level3">
<h3><a href="#example-b-keyboard-controls">Example B. Keyboard controls</a></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode ags"><code class="sourceCode ags"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_color = <span class="dv">14</span><span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_acolor = <span class="dv">13</span><span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dlg_opt_ncolor = <span class="dv">4</span><span class="op">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_get_dimensions</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create a 200x200 dialog options area at (50,100)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">X</span> = <span class="dv">50</span><span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Y</span> = <span class="dv">100</span><span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Width</span> = <span class="dv">200</span><span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Height</span> = <span class="dv">200</span><span class="op">;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">ActiveOptionID</span> = <span class="dv">1</span><span class="op">;</span> <span class="co">// set to first option</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_render</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">)</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">Clear</span><span class="op">(</span>dlg_opt_color<span class="op">);</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ypos = <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Render all the options that are enabled</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i = <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">OptionCount</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionState</span><span class="op">(</span>i<span class="op">)</span> <span class="op">==</span> <span class="bu">eOptionOn</span><span class="op">)</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">ActiveOptionID</span> <span class="op">==</span> i<span class="op">)</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawingColor</span> = dlg_opt_acolor<span class="op">;</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawingColor</span> = dlg_opt_ncolor<span class="op">;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>            info<span class="op">.</span><span class="at">Surface</span><span class="op">.</span><span class="at">DrawStringWrapped</span><span class="op">(</span><span class="dv">5</span><span class="op">,</span> ypos<span class="op">,</span> info<span class="op">.</span><span class="at">Width</span> <span class="op">-</span> <span class="dv">10</span><span class="op">,</span> <span class="bu">eFontNormal</span><span class="op">,</span> <span class="bu">eAlignLeft</span><span class="op">,</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                                           info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span>i<span class="op">));</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>            ypos <span class="op">+</span>= <span class="bu">GetTextHeight</span><span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionText</span><span class="op">(</span>i<span class="op">),</span> <span class="bu">eFontNormal</span><span class="op">,</span> info<span class="op">.</span><span class="at">Width</span> <span class="op">-</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dialog_options_key_press</span><span class="op">(</span><span class="bu">DialogOptionsRenderingInfo</span> <span class="op">*</span>info<span class="op">,</span> <span class="dt">eKeyCode</span> keycode<span class="op">,</span> <span class="dt">int</span> mod<span class="op">)</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>keycode <span class="op">==</span> <span class="bu">eKeyUpArrow</span><span class="op">)</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">// check all options upwards until found an active one</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> next_opt = info<span class="op">.</span><span class="at">ActiveOptionID</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> next_opt <span class="op">&gt;=</span> <span class="dv">1</span><span class="op">;</span> next_opt<span class="op">--)</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionState</span><span class="op">(</span>next_opt<span class="op">)</span> <span class="op">==</span> <span class="bu">eOptionOn</span><span class="op">)</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">ActiveOptionID</span> = next_opt<span class="op">;</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>keycode <span class="op">==</span> <span class="bu">eKeyDownArrow</span><span class="op">)</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">// check all options downwards until found an active one</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> next_opt = info<span class="op">.</span><span class="at">ActiveOptionID</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> next_opt <span class="op">&lt;=</span> info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">OptionCount</span><span class="op">;</span> next_opt<span class="op">++)</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>info<span class="op">.</span><span class="at">DialogToRender</span><span class="op">.</span><span class="at">GetOptionState</span><span class="op">(</span>next_opt<span class="op">)</span> <span class="op">==</span> <span class="bu">eOptionOn</span><span class="op">)</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>            <span class="op">{</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                info<span class="op">.</span><span class="at">ActiveOptionID</span> = next_opt<span class="op">;</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>keycode <span class="op">==</span> <span class="bu">eKeyReturn</span> <span class="op">||</span> keycode <span class="op">==</span> <span class="bu">eKeySpace</span><span class="op">)</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>        info<span class="op">.</span><span class="at">RunActiveOption</span><span class="op">();</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
</section>
      <a class="edit-link" href="https://github.com/adventuregamestudio/ags-manual-source/blob/master/CustomDialogOptions.md" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit this page</a>
      </main>
      <footer>
        <p>
          <a href="jslicensing.html" data-jslicense="1">Third-party JavaScript licensing</a><br>
          Build: ed75ea05a92de6b9ff5582c5376524816e60c494
        </p>
      </footer>
    </article>
    
    <aside>
<ul>
<li><a href="#custom-dialog-options-rendering" id="toc-custom-dialog-options-rendering">Custom dialog options rendering</a>
<ul>
<li><a href="#dialog_options_get_dimensions" id="toc-dialog_options_get_dimensions"><code>dialog_options_get_dimensions</code></a></li>
<li><a href="#dialog_options_render" id="toc-dialog_options_render"><code>dialog_options_render</code></a></li>
<li><a href="#dialog_options_mouse_click" id="toc-dialog_options_mouse_click"><code>dialog_options_mouse_click</code></a></li>
<li><a href="#dialog_options_key_press" id="toc-dialog_options_key_press"><code>dialog_options_key_press</code></a></li>
<li><a href="#dialog_options_text_input" id="toc-dialog_options_text_input"><code>dialog_options_text_input</code></a></li>
<li><a href="#dialog_options_repexec" id="toc-dialog_options_repexec"><code>dialog_options_repexec</code></a></li>
<li><a href="#dialog_options_close" id="toc-dialog_options_close"><code>dialog_options_close</code></a></li>
<li><a href="#dialog_options_get_active" id="toc-dialog_options_get_active"><code>dialog_options_get_active</code></a></li>
<li><a href="#example-a-classic-mouse-controls" id="toc-example-a-classic-mouse-controls">Example A. Classic mouse controls</a></li>
<li><a href="#example-b-keyboard-controls" id="toc-example-b-keyboard-controls">Example B. Keyboard controls</a></li>
</ul></li>
</ul>
    </aside>
  </div>




  </div>
  <script src="js/navigation.js"></script>
  <script src="js/search.js"></script>
  
</body>
</html>
